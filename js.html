<script>
    function crearTablaContactos() {
        //traemos los datos de contactos y programamos y devolvemos datos
        let tabla = document.getElementById('tablaContactos');
                //si existe la borramos
                if(tabla) tabla.remove();
        
     google.script.run.withSuccessHandler(
            function (obj) 
            {
                //sino, la creamos
                tabla = document.createElement('table');
                //le ponemos id para identificarla
                tabla.id = 'tablaContactos';
                let tablaHeader = document.createElement('thead');
                let tablaBody = document.createElement('tbody');
                // CON BUCLE FOR
                for(let i = 0 ; i < obj.length; i++)
                {
                    let fila = document.createElement('tr');
                    for(let j = 0 ; j < obj[i].length ; j++)
                    {
                        let celda = document.createElement('td');
                        celda.textContent = obj[i][j];
                         //añadimos celda a la fila
                         fila.appendChild(celda);
                    }
                 if(i == 0) 
                     {
                        //si es la primela fila, se guarda como cabecera
                         tablaHeader.appendChild(fila);
                        tabla.appendChild(tablaHeader);
                    }
                    else 
                     {
                       tablaBody.appendChild(fila);
                    }
                }
                
                //bucle doble foreach que recorre cada una de las filas y otro para cada celda
                // Array.from(obj).forEach((filaActual, i) => 
                // {
                //     //por cada una de estas fila creamos un elemento de tipo 'tr'->fila
                //     let fila = document.createElement('tr');

                //     filaActual.forEach(celdaActual => 
                //     {
                //         //por cada una de las celdas creamos un elemento de tipo 'td'->fila   
                //         let celda = document.createElement('td');
                //         //guadamos el contenido de la celda en un textContent
                //         celda.textContent = celdaActual;
                //         //añadimos celda a la fila
                //         fila.appendChild(celda);
                //     });
                //     if(i == 0) 
                //     {
                //         //si es la primela fila, se guarda como cabecera
                //         tablaHeader.appendChild(fila);
                //         tabla.appendChild(tablaHeader);
                //     }
                //     else 
                //     {
                //         tablaBody.appendChild(fila);
                //     }
                // });

                // agregamo clases a la cabecera
                tablaHeader.classList.add('table-dark');
                //cuerpo(body) de la tabla donde insertaremos la fila y celda
                tabla.appendChild(tablaBody);

                // agregamos el clases styles a la tabla
                tabla.classList.add('table', 'table-striped', 'border', 'border-3');

                // agregamos tabla a la pagina
                document.getElementById('divContactos').appendChild(tabla);
            }
        ).obtenerContactos();
    }

</script>